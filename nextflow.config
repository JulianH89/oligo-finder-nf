// nextflow.config

params {

    // --- Unique ID for each run --- 
    run_id                = "IRT2_NM_030593_16_002"

    // --- Reference information ---
    bowtie_index_dir      = "$baseDir/data/bowtie_index/hs"
    bowtie_index_prefix   = "hum_refseq_complete_record"

    // --- Target gene ---
    target_gene           = "$baseDir/data/target_gene/multiple_genes.fa"

    // --- Weight Matrix ---
    weight_matrix         = "$baseDir/data/weight_matrix/weight_matrix.txt"

    // --- Requirments for oligo candidates ---
    surrounding_region_length = 45
    oligo_length              = 20
    offset_5_prime            = 16
    offset_gene_region        = 3
    gene_region_length        = 16
    offset_microrna           = 3
    microrna_seed_length      = 7
    min_gc                    = 40.0
    max_gc                    = 60.0
    forbidden_motifs          = "GGG" // e.g. "GGG,AAA,CCCC"

    // --- Bowtie alignment ---
    max_mismatch          = 3

    // --- Output directory ---
    outdir                = "$baseDir/results"
}

process {
  cpus = 2
  memory = '8.GB'
}

// --- Execution Profiles ---
profiles {
    standard {
    }
    docker {
        docker.enabled = true
        
        // This tells Nextflow to automatically build the container if needed.
        docker.build.enabled = true
        docker.build.dockerfile = "$baseDir/Dockerfile"
        docker.container = 'oligo-finder-env'
    }
}


// --- EXECUTION REPORTS ---

// 1. HTML Execution Report
report {
    enabled = true
    file = "${params.outdir}/${params.run_id}/execution_report.html"
}

// 2. HTML Timeline Report
timeline {
    enabled = true
    file = "${params.outdir}/${params.run_id}/timeline.html"
}

// 3. Trace File for detailed resource usage
trace {
    enabled = true
    file = "${params.outdir}/${params.run_id}/trace.txt"
    fields = 'task_id,name,status,exit,start,realtime,%cpu,peak_rss,peak_vmem,submit,container'
}